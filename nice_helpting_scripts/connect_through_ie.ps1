$requestUri = "http://icanhazip.com";

try {
    $res = Invoke-WebRequest -Uri $requestUri
    Write-Host $res.Content
} catch {
    $ie = New-Object -ComObject "InternetExplorer.Application";


    $ie.visible = $false;

    $ie.navigate($requestUri)

    while ($ie.Busy) { Start-Sleep -Milliseconds 100 }

    Write-Host $ie.Document.getElementsByTagName("body")[0].innerText
}

